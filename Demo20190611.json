{"paragraphs":[{"text":"#PySpark Basic","user":"anonymous","dateUpdated":"2019-06-11T06:22:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:1: error: illegal start of definition\n#PySpark Basic\n^\n"}]},"apps":[],"jobName":"paragraph_1560234052723_394478157","id":"20190611-062052_1958834844","dateCreated":"2019-06-11T06:20:52+0000","dateStarted":"2019-06-11T06:22:32+0000","dateFinished":"2019-06-11T06:22:32+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8039"},{"text":"%pyspark \ndata = [1,2,3,4,5]\nrdd  = sc.parallelize(data, 4)\nrdd","user":"anonymous","dateUpdated":"2019-06-11T04:00:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ParallelCollectionRDD[0] at parallelize at PythonRDD.scala:480\n"}]},"apps":[],"jobName":"paragraph_1560225565331_398084051","id":"20190611-035925_881958827","dateCreated":"2019-06-11T03:59:25+0000","dateStarted":"2019-06-11T04:00:18+0000","dateFinished":"2019-06-11T04:01:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8040"},{"text":"%pyspark\nrdd.collect()","user":"anonymous","dateUpdated":"2019-06-11T04:01:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5]\n"}]},"apps":[],"jobName":"paragraph_1560225618869_-783217666","id":"20190611-040018_1837815619","dateCreated":"2019-06-11T04:00:18+0000","dateStarted":"2019-06-11T04:01:38+0000","dateFinished":"2019-06-11T04:01:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8041"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/tibamepy/master/data/trump.txt\nmv trump.txt /tmp/\n","user":"anonymous","dateUpdated":"2019-06-11T05:46:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 05:46:26--  https://raw.githubusercontent.com/ywchiu/tibamepy/master/data/trump.txt\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 8736 (8.5K) [text/plain]\nSaving to: ‘trump.txt’\n\n     0K ........                                              100%  942K=0.009s\n\n2019-06-11 05:46:26 (942 KB/s) - ‘trump.txt’ saved [8736/8736]\n\n"}]},"apps":[],"jobName":"paragraph_1560225698017_229380143","id":"20190611-040138_167797746","dateCreated":"2019-06-11T04:01:38+0000","dateStarted":"2019-06-11T05:46:21+0000","dateFinished":"2019-06-11T05:46:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8042"},{"text":"%pyspark\nlines = sc.textFile('/tmp/trump.txt', 4)\nlines.take(3)","user":"anonymous","dateUpdated":"2019-06-11T05:47:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['The Inaugural Address', '', '']\n"}]},"apps":[],"jobName":"paragraph_1560231981422_221953595","id":"20190611-054621_1645770862","dateCreated":"2019-06-11T05:46:21+0000","dateStarted":"2019-06-11T05:47:50+0000","dateFinished":"2019-06-11T05:47:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8043"},{"text":"%pyspark\n\nrdd=sc.parallelize([1,2,3,4])\nrdd2 = rdd.map(lambda x:x*2)\nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-06-11T05:57:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4, 6, 8]\n"}]},"apps":[],"jobName":"paragraph_1560232038494_-1556078341","id":"20190611-054718_118766663","dateCreated":"2019-06-11T05:47:18+0000","dateStarted":"2019-06-11T05:57:29+0000","dateFinished":"2019-06-11T05:57:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8044"},{"text":"%pyspark\n\nrdd2 = rdd.filter( lambda e: e % 2 ==0)\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-06-11T05:57:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4]\n"}]},"apps":[],"jobName":"paragraph_1560232377996_1659894863","id":"20190611-055257_971174691","dateCreated":"2019-06-11T05:52:57+0000","dateStarted":"2019-06-11T05:57:53+0000","dateFinished":"2019-06-11T05:57:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8045"},{"text":"%pyspark\nrdd2 =sc.parallelize([1, 4, 2, 2, 3])\nrdd3 = rdd2.distinct()\nrdd3.collect()","user":"anonymous","dateUpdated":"2019-06-11T05:59:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4]\n"}]},"apps":[],"jobName":"paragraph_1560232603304_2015339906","id":"20190611-055643_766512419","dateCreated":"2019-06-11T05:56:43+0000","dateStarted":"2019-06-11T05:59:23+0000","dateFinished":"2019-06-11T05:59:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8046"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\n\nrdd2 = rdd.map(lambda x:[x,x+5])\nrdd2.collect()\n\n","user":"anonymous","dateUpdated":"2019-06-11T06:01:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[1, 6], [2, 7], [3, 8]]\n"}]},"apps":[],"jobName":"paragraph_1560232705565_-1013849481","id":"20190611-055825_757847159","dateCreated":"2019-06-11T05:58:25+0000","dateStarted":"2019-06-11T06:01:24+0000","dateFinished":"2019-06-11T06:01:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8047"},{"text":"%pyspark\n\nrdd2 = rdd.flatMap(lambda x:[x,x+5])\nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-06-11T06:02:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 6, 2, 7, 3, 8]\n"}]},"apps":[],"jobName":"paragraph_1560232830712_-178343436","id":"20190611-060030_1371900354","dateCreated":"2019-06-11T06:00:30+0000","dateStarted":"2019-06-11T06:02:10+0000","dateFinished":"2019-06-11T06:02:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8048"},{"text":"%pyspark\ndef func(x):\n    return [x, x + 5]\nimport numpy\na = [1,2,3,4,5]\nna = numpy.array(a)\nfunc(na)","user":"anonymous","dateUpdated":"2019-06-11T06:04:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[array([1, 2, 3, 4, 5]), array([ 6,  7,  8,  9, 10])]\n"}]},"apps":[],"jobName":"paragraph_1560232918955_460401558","id":"20190611-060158_1177991386","dateCreated":"2019-06-11T06:01:58+0000","dateStarted":"2019-06-11T06:04:06+0000","dateFinished":"2019-06-11T06:04:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8049"},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd.reduce(lambda a,b:a*b)\n","user":"anonymous","dateUpdated":"2019-06-11T06:05:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"6\n"}]},"apps":[],"jobName":"paragraph_1560233015285_-1732512286","id":"20190611-060335_1378532782","dateCreated":"2019-06-11T06:03:35+0000","dateStarted":"2019-06-11T06:05:24+0000","dateFinished":"2019-06-11T06:05:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8050"},{"text":"%pyspark\nrdd.take(2)\n","user":"anonymous","dateUpdated":"2019-06-11T06:06:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2]\n"}]},"apps":[],"jobName":"paragraph_1560233124695_-1907436762","id":"20190611-060524_191053214","dateCreated":"2019-06-11T06:05:24+0000","dateStarted":"2019-06-11T06:06:39+0000","dateFinished":"2019-06-11T06:06:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8051"},{"text":"%pyspark\nrdd.collect()","user":"anonymous","dateUpdated":"2019-06-11T06:06:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]},"apps":[],"jobName":"paragraph_1560233198933_-1516993250","id":"20190611-060638_61459839","dateCreated":"2019-06-11T06:06:38+0000","dateStarted":"2019-06-11T06:06:51+0000","dateFinished":"2019-06-11T06:06:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8052"},{"text":"%pyspark\nrdd=sc.parallelize([5,3,1,2])\nrdd.takeOrdered(3,lambda s:-1*s)\n","user":"anonymous","dateUpdated":"2019-06-11T06:07:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[5, 3, 2]\n"}]},"apps":[],"jobName":"paragraph_1560233211443_921175854","id":"20190611-060651_1000321084","dateCreated":"2019-06-11T06:06:51+0000","dateStarted":"2019-06-11T06:07:10+0000","dateFinished":"2019-06-11T06:07:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8053"},{"text":"%pyspark\nrdd = sc.parallelize([(1,2), (3,4), (3,6)]) \nrdd2 = rdd.reduceByKey(lambda a, b: a + b)  \nrdd2.collect()","user":"anonymous","dateUpdated":"2019-06-11T06:14:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 2), (3, 10)]\n"}]},"apps":[],"jobName":"paragraph_1560233223764_1617217263","id":"20190611-060703_423298129","dateCreated":"2019-06-11T06:07:03+0000","dateStarted":"2019-06-11T06:14:40+0000","dateFinished":"2019-06-11T06:14:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8054"},{"text":"%pyspark\nrdd2 = sc.parallelize([(1,'a'), (2,'c'), (1,'b')]) \nrdd3 = rdd2.sortByKey()\nrdd3.collect()","user":"anonymous","dateUpdated":"2019-06-11T06:15:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 'a'), (1, 'b'), (2, 'c')]\n"}]},"apps":[],"jobName":"paragraph_1560233665385_502226986","id":"20190611-061425_1538224060","dateCreated":"2019-06-11T06:14:25+0000","dateStarted":"2019-06-11T06:15:07+0000","dateFinished":"2019-06-11T06:15:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8055"},{"text":"%pyspark\nrdd2 = sc.parallelize([(1,'a'), (2,'c'), (1,'b')]) \nrdd2.groupByKey() \n","user":"anonymous","dateUpdated":"2019-06-11T06:15:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"PythonRDD[75] at RDD at PythonRDD.scala:48\n"}]},"apps":[],"jobName":"paragraph_1560233699125_418012949","id":"20190611-061459_1394834678","dateCreated":"2019-06-11T06:14:59+0000","dateStarted":"2019-06-11T06:15:20+0000","dateFinished":"2019-06-11T06:15:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8056"},{"text":"%pyspark\nbroadcastVar = sc.broadcast([1, 2, 3]) \nbroadcastVar.value","user":"anonymous","dateUpdated":"2019-06-11T06:18:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]},"apps":[],"jobName":"paragraph_1560233720784_96194303","id":"20190611-061520_118582282","dateCreated":"2019-06-11T06:15:20+0000","dateStarted":"2019-06-11T06:18:39+0000","dateFinished":"2019-06-11T06:18:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8057"},{"text":"%pyspark\naccum = sc.accumulator(0) \nrdd = sc.parallelize([1, 2, 3, 4]) \n\ndef f(x): \n    global accum\n    accum += x  \n \nrdd.foreach(f) \naccum.value\n","user":"anonymous","dateUpdated":"2019-06-11T06:20:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]},"apps":[],"jobName":"paragraph_1560233919265_1029497732","id":"20190611-061839_2131502595","dateCreated":"2019-06-11T06:18:39+0000","dateStarted":"2019-06-11T06:20:13+0000","dateFinished":"2019-06-11T06:20:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8058"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.data\nmv u.data /tmp/\nhead /tmp/u.data","user":"anonymous","dateUpdated":"2019-06-11T06:38:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 06:38:52--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.data\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 1979173 (1.9M) [text/plain]\nSaving to: ‘u.data’\n\n     0K .......... .......... .......... .......... ..........  2% 4.08M 0s\n    50K .......... .......... .......... .......... ..........  5% 7.26M 0s\n   100K .......... .......... .......... .......... ..........  7% 9.79M 0s\n   150K .......... .......... .......... .......... .......... 10%  178M 0s\n   200K .......... .......... .......... .......... .......... 12% 20.9M 0s\n   250K .......... .......... .......... .......... .......... 15%  153M 0s\n   300K .......... .......... .......... .......... .......... 18%  230M 0s\n   350K .......... .......... .......... .......... .......... 20%  191M 0s\n   400K .......... .......... .......... .......... .......... 23% 5.67M 0s\n   450K .......... .......... .......... .......... .......... 25%  205M 0s\n   500K .......... .......... .......... .......... .......... 28%  202M 0s\n   550K .......... .......... .......... .......... .......... 31%  175M 0s\n   600K .......... .......... .......... .......... .......... 33%  196M 0s\n   650K .......... .......... .......... .......... .......... 36%  199M 0s\n   700K .......... .......... .......... .......... .......... 38% 7.18M 0s\n   750K .......... .......... .......... .......... .......... 41% 30.8M 0s\n   800K .......... .......... .......... .......... .......... 43% 35.9M 0s\n   850K .......... .......... .......... .......... .......... 46% 8.09M 0s\n   900K .......... .......... .......... .......... .......... 49%  185M 0s\n   950K .......... .......... .......... .......... .......... 51% 7.04M 0s\n  1000K .......... .......... .......... .......... .......... 54% 57.5M 0s\n  1050K .......... .......... .......... .......... .......... 56% 62.1M 0s\n  1100K .......... .......... .......... .......... .......... 59% 61.9M 0s\n  1150K .......... .......... .......... .......... .......... 62% 54.5M 0s\n  1200K .......... .......... .......... .......... .......... 64% 22.9M 0s\n  1250K .......... .......... .......... .......... .......... 67% 62.9M 0s\n  1300K .......... .......... .......... .......... .......... 69% 63.8M 0s\n  1350K .......... .......... .......... .......... .......... 72% 18.8M 0s\n  1400K .......... .......... .......... .......... .......... 75% 11.0M 0s\n  1450K .......... .......... .......... .......... .......... 77%  219M 0s\n  1500K .......... .......... .......... .......... .......... 80%  239M 0s\n  1550K .......... .......... .......... .......... .......... 82%  204M 0s\n  1600K .......... .......... .......... .......... .......... 85%  175M 0s\n  1650K .......... .......... .......... .......... .......... 87%  243M 0s\n  1700K .......... .......... .......... .......... .......... 90%  201M 0s\n  1750K .......... .......... .......... .......... .......... 93%  220M 0s\n  1800K .......... .......... .......... .......... .......... 95%  242M 0s\n  1850K .......... .......... .......... .......... .......... 98%  227M 0s\n  1900K .......... .......... .......... ..                   100%  231M=0.08s\n\n2019-06-11 06:38:52 (24.8 MB/s) - ‘u.data’ saved [1979173/1979173]\n\n196\t242\t3\t881250949\n186\t302\t3\t891717742\n22\t377\t1\t878887116\n244\t51\t2\t880606923\n166\t346\t1\t886397596\n298\t474\t4\t884182806\n115\t265\t2\t881171488\n253\t465\t5\t891628467\n305\t451\t3\t886324817\n6\t86\t3\t883603013\n"}]},"apps":[],"jobName":"paragraph_1560234013785_880153862","id":"20190611-062013_1723431112","dateCreated":"2019-06-11T06:20:13+0000","dateStarted":"2019-06-11T06:38:51+0000","dateFinished":"2019-06-11T06:38:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8059"},{"text":"%pyspark \nrdd = sc.textFile('/tmp/u.data')\nrdd2 = rdd.map(lambda x: int(x.split()[2]) )\nres = rdd2.countByValue()\n#rdd2.take(3)","user":"anonymous","dateUpdated":"2019-06-11T06:44:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560235055075_538570694","id":"20190611-063735_1552271615","dateCreated":"2019-06-11T06:37:35+0000","dateStarted":"2019-06-11T06:44:06+0000","dateFinished":"2019-06-11T06:44:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8060"},{"text":"%pyspark\nfor rec in res.items():\n    print(rec[0], rec[1])","user":"anonymous","dateUpdated":"2019-06-11T06:44:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1 6110\n2 11370\n3 27145\n4 34174\n5 21201\n"}]},"apps":[],"jobName":"paragraph_1560235234373_1086112707","id":"20190611-064034_2122409229","dateCreated":"2019-06-11T06:40:34+0000","dateStarted":"2019-06-11T06:44:31+0000","dateFinished":"2019-06-11T06:44:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8061"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/1800.csv\nmv 1800.csv /tmp/\nhead /tmp/1800.csv","user":"anonymous","dateUpdated":"2019-06-11T06:45:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 06:45:22--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/1800.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 62728 (61K) [text/plain]\nSaving to: ‘1800.csv’\n\n     0K .......... .......... .......... .......... .......... 81% 4.16M 0s\n    50K .......... .                                          100% 20.7M=0.01s\n\n2019-06-11 06:45:23 (4.87 MB/s) - ‘1800.csv’ saved [62728/62728]\n\nITE00100554,18000101,TMAX,-75,,,E,\nITE00100554,18000101,TMIN,-148,,,E,\nGM000010962,18000101,PRCP,0,,,E,\nEZE00100082,18000101,TMAX,-86,,,E,\nEZE00100082,18000101,TMIN,-135,,,E,\nITE00100554,18000102,TMAX,-60,,I,E,\nITE00100554,18000102,TMIN,-125,,,E,\nGM000010962,18000102,PRCP,0,,,E,\nEZE00100082,18000102,TMAX,-44,,,E,\nEZE00100082,18000102,TMIN,-130,,,E,\n"}]},"apps":[],"jobName":"paragraph_1560235452275_1172451347","id":"20190611-064412_1674469587","dateCreated":"2019-06-11T06:44:12+0000","dateStarted":"2019-06-11T06:45:22+0000","dateFinished":"2019-06-11T06:45:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8062"},{"text":"%pyspark\ndef parseLine(line):\n    fields = line.split(',')\n    stationID = fields[0]\n    entryType = fields[2]\n    temperature = float(fields[3]) * 0.1 * (9.0 / 5.0) + 32.0\n    return (stationID, entryType, temperature)\n    \nlines = sc.textFile(\"file:///tmp/1800.csv\")\nparsedLines = lines.map(parseLine)\nparsedLines.take(3)\n","user":"anonymous","dateUpdated":"2019-06-11T06:47:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('ITE00100554', 'TMAX', 18.5), ('ITE00100554', 'TMIN', 5.359999999999999), ('GM000010962', 'PRCP', 32.0)]\n"}]},"apps":[],"jobName":"paragraph_1560235522283_-636794512","id":"20190611-064522_1381032178","dateCreated":"2019-06-11T06:45:22+0000","dateStarted":"2019-06-11T06:47:22+0000","dateFinished":"2019-06-11T06:47:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8063"},{"text":"%pyspark\nminTemps = parsedLines.filter(lambda x: \"TMIN\" in x[1])\nstationTemps = minTemps.map(lambda x: (x[0], x[2]))\nstationTemps.take(3)","user":"anonymous","dateUpdated":"2019-06-11T06:48:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('ITE00100554', 5.359999999999999), ('EZE00100082', 7.699999999999999), ('ITE00100554', 9.5)]\n"}]},"apps":[],"jobName":"paragraph_1560235634131_-1587708258","id":"20190611-064714_108859729","dateCreated":"2019-06-11T06:47:14+0000","dateStarted":"2019-06-11T06:48:34+0000","dateFinished":"2019-06-11T06:48:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8064"},{"text":"%pyspark\nminTemps = stationTemps.reduceByKey(lambda x, y: min(x,y))\nresults = minTemps.collect()\nresults[0:3]","user":"anonymous","dateUpdated":"2019-06-11T06:49:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('ITE00100554', 5.359999999999999), ('EZE00100082', 7.699999999999999)]\n"}]},"apps":[],"jobName":"paragraph_1560235714453_-819041253","id":"20190611-064834_1568818714","dateCreated":"2019-06-11T06:48:34+0000","dateStarted":"2019-06-11T06:49:16+0000","dateFinished":"2019-06-11T06:49:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8065"},{"text":"%pyspark\ninput = sc.textFile('/tmp/trump.txt')\nwords = input.map(lambda x: x.upper())\nwords = words.flatMap(lambda x: x.split())\nwordCounts = words.countByValue()\nswd = sorted(wordCounts.items(), key=lambda x: x[1], reverse=True)","user":"anonymous","dateUpdated":"2019-06-11T07:19:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560235747253_-1519471430","id":"20190611-064907_1676276867","dateCreated":"2019-06-11T06:49:07+0000","dateStarted":"2019-06-11T07:19:06+0000","dateFinished":"2019-06-11T07:19:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8066"},{"text":"%sh\npip install jieba","user":"anonymous","dateUpdated":"2019-06-11T07:19:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Collecting jieba\n  Downloading https://files.pythonhosted.org/packages/71/46/c6f9179f73b818d5827202ad1c4a94e371a29473b7f043b736b4dab6b8cd/jieba-0.39.zip (7.3MB)\nInstalling collected packages: jieba\n  Running setup.py install for jieba: started\n    Running setup.py install for jieba: finished with status 'done'\nSuccessfully installed jieba-0.39\n"}]},"apps":[],"jobName":"paragraph_1560237247279_-694976439","id":"20190611-071407_2012528164","dateCreated":"2019-06-11T07:14:07+0000","dateStarted":"2019-06-11T07:19:57+0000","dateFinished":"2019-06-11T07:20:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8067"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/ctbcpy/master/data/speech.txt\nmv speech.txt /tmp/\nhead /tmp/speech.txt","user":"anonymous","dateUpdated":"2019-06-11T07:23:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 07:23:17--  https://raw.githubusercontent.com/ywchiu/ctbcpy/master/data/speech.txt\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 7040 (6.9K) [text/plain]\nSaving to: ‘speech.txt’\n\n     0K ......                                                100% 17.7M=0s\n\n2019-06-11 07:23:17 (17.7 MB/s) - ‘speech.txt’ saved [7040/7040]\n\n各位國人同胞，記者朋友，大家早安。\n\n今天，雨下得很大，我希望國人同胞要注意交通安全，我也請蘇院長及行政團隊要做好必要的準備。\n\n今天是我就職滿三年，我有一些感想，要和各位分享。\n\n前天星期六，台灣第一座離岸風場，終於開始施工了。風機葉片現在就在台中港，等待運送到海上組裝。一切順利的話，我們在今年底就會完成這座風場，將會創下一個重要的里程碑。\n\n再生能源的夢想，台灣談了十幾年。從我上任之後，三年來經過修法、簽約、議價、開工，才終於要實現。\n\n"}]},"apps":[],"jobName":"paragraph_1560237597489_-529661939","id":"20190611-071957_651793281","dateCreated":"2019-06-11T07:19:57+0000","dateStarted":"2019-06-11T07:23:17+0000","dateFinished":"2019-06-11T07:23:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8068"},{"text":"%pyspark\nimport jieba\ninput = sc.textFile('/tmp/speech.txt')\nwords = input.flatMap(lambda e: list(jieba.cut(e)) )\nwords = words.filter(lambda x: len(x) > 1)\nwordCounts = words.countByValue()\nswd = sorted(wordCounts.items(), key=lambda x: x[1], reverse=True)\nswd[0:30]","user":"anonymous","dateUpdated":"2019-06-11T07:25:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('台灣', 25), ('我們', 20), ('三年', 11), ('就是', 10), ('經濟', 9), ('一個', 9), ('國家', 8), ('但是', 7), ('必須', 6), ('未來', 6), ('大家', 6), ('過去', 6), ('這個', 5), ('很多', 5), ('產業', 5), ('可以', 5), ('朋友', 4), ('重要', 4), ('投資', 4), ('很大', 4), ('只有', 4), ('我要', 4), ('努力', 4), ('成長', 4), ('MIT', 4), ('全世界', 3), ('穩定', 3), ('國人', 3), ('關鍵', 3), ('創造', 3)]\n"}]},"apps":[],"jobName":"paragraph_1560237784312_1904737941","id":"20190611-072304_1223561488","dateCreated":"2019-06-11T07:23:04+0000","dateStarted":"2019-06-11T07:25:49+0000","dateFinished":"2019-06-11T07:25:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8069"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/kddcup.data_10_percent.gz\nmv kddcup.data_10_percent.gz /tmp/","user":"anonymous","dateUpdated":"2019-06-11T07:31:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 07:31:15--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/kddcup.data_10_percent.gz\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2144903 (2.0M) [application/octet-stream]\nSaving to: ‘kddcup.data_10_percent.gz’\n\n     0K .......... .......... .......... .......... ..........  2% 2.48M 1s\n    50K .......... .......... .......... .......... ..........  4% 39.3M 0s\n   100K .......... .......... .......... .......... ..........  7%  163M 0s\n   150K .......... .......... .......... .......... ..........  9% 25.5M 0s\n   200K .......... .......... .......... .......... .......... 11% 7.23M 0s\n   250K .......... .......... .......... .......... .......... 14% 51.2M 0s\n   300K .......... .......... .......... .......... .......... 16% 8.93M 0s\n   350K .......... .......... .......... .......... .......... 19%  190M 0s\n   400K .......... .......... .......... .......... .......... 21%  219M 0s\n   450K .......... .......... .......... .......... .......... 23%  239M 0s\n   500K .......... .......... .......... .......... .......... 26% 42.8M 0s\n   550K .......... .......... .......... .......... .......... 28% 24.1M 0s\n   600K .......... .......... .......... .......... .......... 31% 62.2M 0s\n   650K .......... .......... .......... .......... .......... 33% 27.4M 0s\n   700K .......... .......... .......... .......... .......... 35% 59.9M 0s\n   750K .......... .......... .......... .......... .......... 38% 52.1M 0s\n   800K .......... .......... .......... .......... .......... 40% 61.3M 0s\n   850K .......... .......... .......... .......... .......... 42% 9.86M 0s\n   900K .......... .......... .......... .......... .......... 45% 58.7M 0s\n   950K .......... .......... .......... .......... .......... 47% 15.2M 0s\n  1000K .......... .......... .......... .......... .......... 50% 47.8M 0s\n  1050K .......... .......... .......... .......... .......... 52% 55.2M 0s\n  1100K .......... .......... .......... .......... .......... 54% 16.7M 0s\n  1150K .......... .......... .......... .......... .......... 57% 49.2M 0s\n  1200K .......... .......... .......... .......... .......... 59% 60.6M 0s\n  1250K .......... .......... .......... .......... .......... 62% 66.4M 0s\n  1300K .......... .......... .......... .......... .......... 64% 65.5M 0s\n  1350K .......... .......... .......... .......... .......... 66% 11.7M 0s\n  1400K .......... .......... .......... .......... .......... 69% 50.9M 0s\n  1450K .......... .......... .......... .......... .......... 71% 61.0M 0s\n  1500K .......... .......... .......... .......... .......... 73% 31.0M 0s\n  1550K .......... .......... .......... .......... .......... 76% 56.1M 0s\n  1600K .......... .......... .......... .......... .......... 78% 61.5M 0s\n  1650K .......... .......... .......... .......... .......... 81% 48.9M 0s\n  1700K .......... .......... .......... .......... .......... 83% 66.4M 0s\n  1750K .......... .......... .......... .......... .......... 85% 60.1M 0s\n  1800K .......... .......... .......... .......... .......... 88% 68.7M 0s\n  1850K .......... .......... .......... .......... .......... 90% 13.2M 0s\n  1900K .......... .......... .......... .......... .......... 93% 9.95M 0s\n  1950K .......... .......... .......... .......... .......... 95% 54.4M 0s\n  2000K .......... .......... .......... .......... .......... 97% 56.7M 0s\n  2050K .......... .......... .......... .......... ....      100% 59.8M=0.09s\n\n2019-06-11 07:31:16 (23.8 MB/s) - ‘kddcup.data_10_percent.gz’ saved [2144903/2144903]\n\n"}]},"apps":[],"jobName":"paragraph_1560237824850_-707276369","id":"20190611-072344_2019834244","dateCreated":"2019-06-11T07:23:44+0000","dateStarted":"2019-06-11T07:31:15+0000","dateFinished":"2019-06-11T07:31:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8070"},{"text":"%pyspark\ndata_file = \"file:///tmp/kddcup.data_10_percent.gz\"\nraw_data = sc.textFile(data_file)\nraw_data.count()\n","user":"anonymous","dateUpdated":"2019-06-11T07:32:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"494021\n"}]},"apps":[],"jobName":"paragraph_1560238275508_-1668924214","id":"20190611-073115_2042123610","dateCreated":"2019-06-11T07:31:15+0000","dateStarted":"2019-06-11T07:32:10+0000","dateFinished":"2019-06-11T07:32:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8071"},{"text":"%pyspark\nraw_data_sample = raw_data.sample(False, 0.1, 1234)\nraw_data_sample.take(3)\nsample_size = raw_data_sample.count()\ntotal_size = raw_data.count()\nprint(sample_size, total_size)\n","user":"anonymous","dateUpdated":"2019-06-11T07:33:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"49493 494021\n"}]},"apps":[],"jobName":"paragraph_1560238291840_624979377","id":"20190611-073131_681203375","dateCreated":"2019-06-11T07:31:31+0000","dateStarted":"2019-06-11T07:33:59+0000","dateFinished":"2019-06-11T07:34:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8072"},{"text":"%pyspark\nrow_data = raw_data_sample.map(lambda x: x.split(',')[1])\nrow_data.countByValue()","user":"anonymous","dateUpdated":"2019-06-11T07:36:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defaultdict(<class 'int'>, {'icmp': 28488, 'udp': 2016, 'tcp': 18989})\n"}]},"apps":[],"jobName":"paragraph_1560238396740_-535302357","id":"20190611-073316_1261462641","dateCreated":"2019-06-11T07:33:16+0000","dateStarted":"2019-06-11T07:36:11+0000","dateFinished":"2019-06-11T07:36:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8073"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/fakefriends.csv\nmv fakefriends.csv /tmp/\nhead /tmp/fakefriends.csv","user":"anonymous","dateUpdated":"2019-06-11T07:38:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 07:38:56--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/fakefriends.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 8254 (8.1K) [text/plain]\nSaving to: ‘fakefriends.csv’\n\n     0K ........                                              100% 19.3M=0s\n\n2019-06-11 07:38:56 (19.3 MB/s) - ‘fakefriends.csv’ saved [8254/8254]\n\n0,Will,33,385\n1,Jean-Luc,26,2\n2,Hugh,55,221\n3,Deanna,40,465\n4,Quark,68,21\n5,Weyoun,59,318\n6,Gowron,37,220\n7,Will,54,307\n8,Jadzia,38,380\n9,Hugh,27,181\n"}]},"apps":[],"jobName":"paragraph_1560238485420_1412635352","id":"20190611-073445_1798785735","dateCreated":"2019-06-11T07:34:45+0000","dateStarted":"2019-06-11T07:38:56+0000","dateFinished":"2019-06-11T07:38:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8074"},{"text":"%pyspark\ndef parseLine(line):\n    fields = line.split(',')\n    age = int(fields[2])\n    numFriends = int(fields[3])\n    return (age, numFriends)\n\nlines = sc.textFile(\"file:///tmp/fakefriends.csv\")\nrdd = lines.map(parseLine)\nrdd.take(3)","user":"anonymous","dateUpdated":"2019-06-11T07:40:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(33, 385), (26, 2), (55, 221)]\n"}]},"apps":[],"jobName":"paragraph_1560238624260_348018177","id":"20190611-073704_675110403","dateCreated":"2019-06-11T07:37:04+0000","dateStarted":"2019-06-11T07:40:02+0000","dateFinished":"2019-06-11T07:40:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8075"},{"text":"%pyspark\nrdd2 = rdd.mapValues(lambda x: (x, 1))\nrdd2.take(3)","user":"anonymous","dateUpdated":"2019-06-11T07:41:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(33, (385, 1)), (26, (2, 1)), (55, (221, 1))]\n"}]},"apps":[],"jobName":"paragraph_1560238802188_1306320418","id":"20190611-074002_632877625","dateCreated":"2019-06-11T07:40:02+0000","dateStarted":"2019-06-11T07:41:23+0000","dateFinished":"2019-06-11T07:41:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8076"},{"text":"%pyspark\ntotalsByAge = rdd2.reduceByKey(lambda x, y: (x[0] + y[0], x[1] + y[1]))\nrdd3.take(3)","user":"anonymous","dateUpdated":"2019-06-11T07:42:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(18, (2747, 8)), (19, (2346, 11)), (20, (825, 5))]\n"}]},"apps":[],"jobName":"paragraph_1560238883650_-2045152275","id":"20190611-074123_1493633730","dateCreated":"2019-06-11T07:41:23+0000","dateStarted":"2019-06-11T07:42:36+0000","dateFinished":"2019-06-11T07:42:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8077"},{"text":"%pyspark\naveragesByAge = totalsByAge.mapValues(lambda x: x[0] / x[1])\nresults = averagesByAge.collect()\nresults[0:3]","user":"anonymous","dateUpdated":"2019-06-11T07:43:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(18, 343.375), (19, 213.27272727272728), (20, 165.0)]\n"}]},"apps":[],"jobName":"paragraph_1560238904940_1306810791","id":"20190611-074144_1967227077","dateCreated":"2019-06-11T07:41:44+0000","dateStarted":"2019-06-11T07:43:27+0000","dateFinished":"2019-06-11T07:43:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8078"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/customer-orders.csv\nmv customer-orders.csv /tmp/\nhead /tmp/customer-orders.csv","user":"anonymous","dateUpdated":"2019-06-11T07:44:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 07:44:14--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/customer-orders.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 136855 (134K) [text/plain]\nSaving to: ‘customer-orders.csv’\n\n     0K .......... .......... .......... .......... .......... 37% 3.27M 0s\n    50K .......... .......... .......... .......... .......... 74% 6.61M 0s\n   100K .......... .......... .......... ...                  100%  164M=0.02s\n\n2019-06-11 07:44:14 (5.79 MB/s) - ‘customer-orders.csv’ saved [136855/136855]\n\n44,8602,37.19\n35,5368,65.89\n2,3391,40.64\n47,6694,14.98\n29,680,13.08\n91,8900,24.59\n70,3959,68.68\n85,1733,28.53\n53,9900,83.55\n14,1505,4.32\n"}]},"apps":[],"jobName":"paragraph_1560238936570_-1963524211","id":"20190611-074216_634619516","dateCreated":"2019-06-11T07:42:16+0000","dateStarted":"2019-06-11T07:44:14+0000","dateFinished":"2019-06-11T07:44:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8079"},{"text":"%pyspark\ndef extractCustomerPricePairs(line):\n    fields = line.split(',')\n    return (int(fields[0]), float(fields[2]))\ninput = sc.textFile(\"file:///tmp/customer-orders.csv\")\nmappedInput = input.map(extractCustomerPricePairs)\nmappedInput.take(3)\n\ntotalByCustomer = mappedInput.reduceByKey(lambda x, y: x + y)\n\nresults = totalByCustomer.take(3)\nresults","user":"anonymous","dateUpdated":"2019-06-11T07:47:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(0, 5524.949999999998), (1, 4958.600000000001), (2, 5994.59)]\n"}]},"apps":[],"jobName":"paragraph_1560239054140_-697514795","id":"20190611-074414_1337828428","dateCreated":"2019-06-11T07:44:14+0000","dateStarted":"2019-06-11T07:47:58+0000","dateFinished":"2019-06-11T07:47:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8080"},{"text":"%pyspark\nlines = sc.textFile(\"file:///tmp/u.data\")\nlines.take(3)\nmovies= lines.map(lambda x : (int(x.split()[1]) , 1) )\nmovies.take(3)\nmovieCounts = movies.reduceByKey(lambda x,y: x+ y)\nmovieCounts.take(3)\nres = movieCounts.sortBy(lambda a: -a[1])\nres.take(3)","user":"anonymous","dateUpdated":"2019-06-11T07:50:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(50, 583), (258, 509), (100, 508)]\n"}]},"apps":[],"jobName":"paragraph_1560239143888_-1879524713","id":"20190611-074543_1416292372","dateCreated":"2019-06-11T07:45:43+0000","dateStarted":"2019-06-11T07:50:30+0000","dateFinished":"2019-06-11T07:50:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8081"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.item\nmv u.item /tmp/\nhead /tmp/u.item","user":"anonymous","dateUpdated":"2019-06-11T07:52:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 07:52:10--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/u.item\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [text/plain]\nSaving to: ‘u.item’\n\n     0K .......... .......... .......... .......... .......... 21% 3.47M 0s\n    50K .......... .......... .......... .......... .......... 43% 6.90M 0s\n   100K .......... .......... .......... .......... .......... 64% 41.3M 0s\n   150K .......... .......... .......... .......... .......... 86% 58.8M 0s\n   200K .......... .......... ..........                      100% 5.34M=0.03s\n\n2019-06-11 07:52:10 (7.83 MB/s) - ‘u.item’ saved [236344/236344]\n\n1|Toy Story (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)|0|0|0|1|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0\n2|GoldenEye (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?GoldenEye%20(1995)|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0\n3|Four Rooms (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Four%20Rooms%20(1995)|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0\n4|Get Shorty (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Get%20Shorty%20(1995)|0|1|0|0|0|1|0|0|1|0|0|0|0|0|0|0|0|0|0\n5|Copycat (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Copycat%20(1995)|0|0|0|0|0|0|1|0|1|0|0|0|0|0|0|0|1|0|0\n6|Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)|01-Jan-1995||http://us.imdb.com/Title?Yao+a+yao+yao+dao+waipo+qiao+(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0\n7|Twelve Monkeys (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Twelve%20Monkeys%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|1|0|0|0\n8|Babe (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Babe%20(1995)|0|0|0|0|1|1|0|0|1|0|0|0|0|0|0|0|0|0|0\n9|Dead Man Walking (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Dead%20Man%20Walking%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0\n10|Richard III (1995)|22-Jan-1996||http://us.imdb.com/M/title-exact?Richard%20III%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|1|0\n"}]},"apps":[],"jobName":"paragraph_1560239329140_-1704216609","id":"20190611-074849_473283905","dateCreated":"2019-06-11T07:48:49+0000","dateStarted":"2019-06-11T07:52:10+0000","dateFinished":"2019-06-11T07:52:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8082"},{"text":"%pyspark\ndef loadMovieNames():\n    movieNames = {}\n    with open('/tmp/u.item', 'r', encoding = 'iso-8859-1') as f:\n        for line in f:\n            fields = line.strip().split('|')\n            movieNames[int(fields[0])] = fields[1]\n    return movieNames\nnameDict = sc.broadcast(loadMovieNames())\n","user":"anonymous","dateUpdated":"2019-06-11T07:55:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560239530530_1741684841","id":"20190611-075210_1861688364","dateCreated":"2019-06-11T07:52:10+0000","dateStarted":"2019-06-11T07:55:46+0000","dateFinished":"2019-06-11T07:55:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8083"},{"text":"%pyspark\n# nameDict.value\nres2 = res.map(lambda e: (nameDict.value.get(e[0]), e[1]))\nres2.take(10)","user":"anonymous","dateUpdated":"2019-06-11T07:55:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Star Wars (1977)', 583), ('Contact (1997)', 509), ('Fargo (1996)', 508), ('Return of the Jedi (1983)', 507), ('Liar Liar (1997)', 485), ('English Patient, The (1996)', 481), ('Scream (1996)', 478), ('Toy Story (1995)', 452), ('Air Force One (1997)', 431), ('Independence Day (ID4) (1996)', 429)]\n"}]},"apps":[],"jobName":"paragraph_1560239614378_-802150648","id":"20190611-075334_484020086","dateCreated":"2019-06-11T07:53:34+0000","dateStarted":"2019-06-11T07:55:49+0000","dateFinished":"2019-06-11T07:55:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8084"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-06-11T07:54:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560239648568_-1159536404","id":"20190611-075408_1699267423","dateCreated":"2019-06-11T07:54:08+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8085"}],"name":"Demo20190611","id":"2EF9S3X4R","angularObjects":{"2ECB8EECR:shared_process":[],"2ED1HD7NS:shared_process":[],"2EE9P3FDB:shared_process":[],"2EFC7YPSA:shared_process":[],"2EDTYY9UC:shared_process":[],"2EF7FMM2J:shared_process":[],"2EEFHWQN7:shared_process":[],"2EC3SCQSX:shared_process":[],"2EE19MJ8U:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}