{"paragraphs":[{"text":"#PySpark Basic","user":"anonymous","dateUpdated":"2019-06-11T06:22:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560234052723_394478157","id":"20190611-062052_1958834844","dateCreated":"2019-06-11T06:20:52+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2598","dateFinished":"2019-06-11T06:22:32+0000","dateStarted":"2019-06-11T06:22:32+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:1: error: illegal start of definition\n#PySpark Basic\n^\n"}]}},{"text":"%pyspark \ndata = [1,2,3,4,5]\nrdd  = sc.parallelize(data, 4)\nrdd","user":"anonymous","dateUpdated":"2019-06-11T04:00:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ParallelCollectionRDD[0] at parallelize at PythonRDD.scala:480\n"}]},"apps":[],"jobName":"paragraph_1560225565331_398084051","id":"20190611-035925_881958827","dateCreated":"2019-06-11T03:59:25+0000","dateStarted":"2019-06-11T04:00:18+0000","dateFinished":"2019-06-11T04:01:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:368"},{"text":"%pyspark\nrdd.collect()","user":"anonymous","dateUpdated":"2019-06-11T04:01:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5]\n"}]},"apps":[],"jobName":"paragraph_1560225618869_-783217666","id":"20190611-040018_1837815619","dateCreated":"2019-06-11T04:00:18+0000","dateStarted":"2019-06-11T04:01:38+0000","dateFinished":"2019-06-11T04:01:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:369"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/tibamepy/master/data/trump.txt\nmv trump.txt /tmp/\n","user":"anonymous","dateUpdated":"2019-06-11T05:46:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560225698017_229380143","id":"20190611-040138_167797746","dateCreated":"2019-06-11T04:01:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:370","dateFinished":"2019-06-11T05:46:26+0000","dateStarted":"2019-06-11T05:46:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-11 05:46:26--  https://raw.githubusercontent.com/ywchiu/tibamepy/master/data/trump.txt\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 8736 (8.5K) [text/plain]\nSaving to: ‘trump.txt’\n\n     0K ........                                              100%  942K=0.009s\n\n2019-06-11 05:46:26 (942 KB/s) - ‘trump.txt’ saved [8736/8736]\n\n"}]}},{"text":"%pyspark\nlines = sc.textFile('/tmp/trump.txt', 4)\nlines.take(3)","user":"anonymous","dateUpdated":"2019-06-11T05:47:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560231981422_221953595","id":"20190611-054621_1645770862","dateCreated":"2019-06-11T05:46:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:576","dateFinished":"2019-06-11T05:47:52+0000","dateStarted":"2019-06-11T05:47:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['The Inaugural Address', '', '']\n"}]}},{"text":"%pyspark\n\nrdd=sc.parallelize([1,2,3,4])\nrdd2 = rdd.map(lambda x:x*2)\nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-06-11T05:57:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560232038494_-1556078341","id":"20190611-054718_118766663","dateCreated":"2019-06-11T05:47:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:661","dateFinished":"2019-06-11T05:57:29+0000","dateStarted":"2019-06-11T05:57:29+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4, 6, 8]\n"}]}},{"text":"%pyspark\n\nrdd2 = rdd.filter( lambda e: e % 2 ==0)\nrdd2.collect()","user":"anonymous","dateUpdated":"2019-06-11T05:57:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560232377996_1659894863","id":"20190611-055257_971174691","dateCreated":"2019-06-11T05:52:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:865","dateFinished":"2019-06-11T05:57:53+0000","dateStarted":"2019-06-11T05:57:53+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4]\n"}]}},{"text":"%pyspark\nrdd2 =sc.parallelize([1, 4, 2, 2, 3])\nrdd3 = rdd2.distinct()\nrdd3.collect()","user":"anonymous","dateUpdated":"2019-06-11T05:59:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560232603304_2015339906","id":"20190611-055643_766512419","dateCreated":"2019-06-11T05:56:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1102","dateFinished":"2019-06-11T05:59:25+0000","dateStarted":"2019-06-11T05:59:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4]\n"}]}},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\n\nrdd2 = rdd.map(lambda x:[x,x+5])\nrdd2.collect()\n\n","user":"anonymous","dateUpdated":"2019-06-11T06:01:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560232705565_-1013849481","id":"20190611-055825_757847159","dateCreated":"2019-06-11T05:58:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1261","dateFinished":"2019-06-11T06:01:24+0000","dateStarted":"2019-06-11T06:01:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[1, 6], [2, 7], [3, 8]]\n"}]}},{"text":"%pyspark\n\nrdd2 = rdd.flatMap(lambda x:[x,x+5])\nrdd2.collect()\n","user":"anonymous","dateUpdated":"2019-06-11T06:02:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560232830712_-178343436","id":"20190611-060030_1371900354","dateCreated":"2019-06-11T06:00:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1465","dateFinished":"2019-06-11T06:02:10+0000","dateStarted":"2019-06-11T06:02:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 6, 2, 7, 3, 8]\n"}]}},{"text":"%pyspark\ndef func(x):\n    return [x, x + 5]\nimport numpy\na = [1,2,3,4,5]\nna = numpy.array(a)\nfunc(na)","user":"anonymous","dateUpdated":"2019-06-11T06:04:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560232918955_460401558","id":"20190611-060158_1177991386","dateCreated":"2019-06-11T06:01:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1600","dateFinished":"2019-06-11T06:04:06+0000","dateStarted":"2019-06-11T06:04:06+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[array([1, 2, 3, 4, 5]), array([ 6,  7,  8,  9, 10])]\n"}]}},{"text":"%pyspark\nrdd=sc.parallelize([1,2,3])\nrdd.reduce(lambda a,b:a*b)\n","user":"anonymous","dateUpdated":"2019-06-11T06:05:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233015285_-1732512286","id":"20190611-060335_1378532782","dateCreated":"2019-06-11T06:03:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1699","dateFinished":"2019-06-11T06:05:25+0000","dateStarted":"2019-06-11T06:05:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"6\n"}]}},{"text":"%pyspark\nrdd.take(2)\n","user":"anonymous","dateUpdated":"2019-06-11T06:06:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233124695_-1907436762","id":"20190611-060524_191053214","dateCreated":"2019-06-11T06:05:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1814","dateFinished":"2019-06-11T06:06:39+0000","dateStarted":"2019-06-11T06:06:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2]\n"}]}},{"text":"%pyspark\nrdd.collect()","user":"anonymous","dateUpdated":"2019-06-11T06:06:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233198933_-1516993250","id":"20190611-060638_61459839","dateCreated":"2019-06-11T06:06:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1895","dateFinished":"2019-06-11T06:06:51+0000","dateStarted":"2019-06-11T06:06:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]}},{"text":"%pyspark\nrdd=sc.parallelize([5,3,1,2])\nrdd.takeOrdered(3,lambda s:-1*s)\n","user":"anonymous","dateUpdated":"2019-06-11T06:07:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233211443_921175854","id":"20190611-060651_1000321084","dateCreated":"2019-06-11T06:06:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1976","dateFinished":"2019-06-11T06:07:11+0000","dateStarted":"2019-06-11T06:07:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[5, 3, 2]\n"}]}},{"text":"%pyspark\nrdd = sc.parallelize([(1,2), (3,4), (3,6)]) \nrdd2 = rdd.reduceByKey(lambda a, b: a + b)  \nrdd2.collect()","user":"anonymous","dateUpdated":"2019-06-11T06:14:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233223764_1617217263","id":"20190611-060703_423298129","dateCreated":"2019-06-11T06:07:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2057","dateFinished":"2019-06-11T06:14:41+0000","dateStarted":"2019-06-11T06:14:40+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 2), (3, 10)]\n"}]}},{"text":"%pyspark\nrdd2 = sc.parallelize([(1,'a'), (2,'c'), (1,'b')]) \nrdd3 = rdd2.sortByKey()\nrdd3.collect()","user":"anonymous","dateUpdated":"2019-06-11T06:15:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233665385_502226986","id":"20190611-061425_1538224060","dateCreated":"2019-06-11T06:14:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2156","dateFinished":"2019-06-11T06:15:08+0000","dateStarted":"2019-06-11T06:15:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 'a'), (1, 'b'), (2, 'c')]\n"}]}},{"text":"%pyspark\nrdd2 = sc.parallelize([(1,'a'), (2,'c'), (1,'b')]) \nrdd2.groupByKey() \n","user":"anonymous","dateUpdated":"2019-06-11T06:15:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233699125_418012949","id":"20190611-061459_1394834678","dateCreated":"2019-06-11T06:14:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2261","dateFinished":"2019-06-11T06:15:21+0000","dateStarted":"2019-06-11T06:15:20+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"PythonRDD[75] at RDD at PythonRDD.scala:48\n"}]}},{"text":"%pyspark\nbroadcastVar = sc.broadcast([1, 2, 3]) \nbroadcastVar.value","user":"anonymous","dateUpdated":"2019-06-11T06:18:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233720784_96194303","id":"20190611-061520_118582282","dateCreated":"2019-06-11T06:15:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2358","dateFinished":"2019-06-11T06:18:39+0000","dateStarted":"2019-06-11T06:18:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3]\n"}]}},{"text":"%pyspark\naccum = sc.accumulator(0) \nrdd = sc.parallelize([1, 2, 3, 4]) \n\ndef f(x): \n    global accum\n    accum += x  \n \nrdd.foreach(f) \naccum.value\n","user":"anonymous","dateUpdated":"2019-06-11T06:20:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560233919265_1029497732","id":"20190611-061839_2131502595","dateCreated":"2019-06-11T06:18:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2439","dateFinished":"2019-06-11T06:20:14+0000","dateStarted":"2019-06-11T06:20:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-06-11T06:20:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560234013785_880153862","id":"20190611-062013_1723431112","dateCreated":"2019-06-11T06:20:13+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2511"}],"name":"Demo20190611","id":"2EF9S3X4R","angularObjects":{"2ECB8EECR:shared_process":[],"2ED1HD7NS:shared_process":[],"2EE9P3FDB:shared_process":[],"2EFC7YPSA:shared_process":[],"2EDTYY9UC:shared_process":[],"2EF7FMM2J:shared_process":[],"2EEFHWQN7:shared_process":[],"2EC3SCQSX:shared_process":[],"2EE19MJ8U:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}