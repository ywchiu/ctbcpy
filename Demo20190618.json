{"paragraphs":[{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/churnTrain.csv\nmv churnTrain.csv /tmp/","user":"anonymous","dateUpdated":"2019-06-18T02:09:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-18 02:09:56--  https://raw.githubusercontent.com/ywchiu/micronbigdata/master/Spark/churnTrain.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 356734 (348K) [text/plain]\nSaving to: ‘churnTrain.csv’\n\n     0K .......... .......... .......... .......... .......... 14% 4.77M 0s\n    50K .......... .......... .......... .......... .......... 28% 6.92M 0s\n   100K .......... .......... .......... .......... .......... 43% 43.8M 0s\n   150K .......... .......... .......... .......... .......... 57% 60.4M 0s\n   200K .......... .......... .......... .......... .......... 71% 8.51M 0s\n   250K .......... .......... .......... .......... .......... 86% 59.3M 0s\n   300K .......... .......... .......... .......... ........  100% 65.7M=0.03s\n\n2019-06-18 02:09:56 (12.8 MB/s) - ‘churnTrain.csv’ saved [356734/356734]\n\n"}]},"apps":[],"jobName":"paragraph_1560823774837_-1620584433","id":"20190618-020934_514886973","dateCreated":"2019-06-18T02:09:34+0000","dateStarted":"2019-06-18T02:09:53+0000","dateFinished":"2019-06-18T02:09:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4423"},{"text":"%sh\nhead /tmp/churnTrain.csv","user":"anonymous","dateUpdated":"2019-06-18T02:10:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\"\",\"state\",\"account_length\",\"area_code\",\"international_plan\",\"voice_mail_plan\",\"number_vmail_messages\",\"total_day_minutes\",\"total_day_calls\",\"total_day_charge\",\"total_eve_minutes\",\"total_eve_calls\",\"total_eve_charge\",\"total_night_minutes\",\"total_night_calls\",\"total_night_charge\",\"total_intl_minutes\",\"total_intl_calls\",\"total_intl_charge\",\"number_customer_service_calls\",\"churn\"\n\"1\",\"KS\",128,\"area_code_415\",\"no\",\"yes\",25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10,3,2.7,1,\"no\"\n\"2\",\"OH\",107,\"area_code_415\",\"no\",\"yes\",26,161.6,123,27.47,195.5,103,16.62,254.4,103,11.45,13.7,3,3.7,1,\"no\"\n\"3\",\"NJ\",137,\"area_code_415\",\"no\",\"no\",0,243.4,114,41.38,121.2,110,10.3,162.6,104,7.32,12.2,5,3.29,0,\"no\"\n\"4\",\"OH\",84,\"area_code_408\",\"yes\",\"no\",0,299.4,71,50.9,61.9,88,5.26,196.9,89,8.86,6.6,7,1.78,2,\"no\"\n\"5\",\"OK\",75,\"area_code_415\",\"yes\",\"no\",0,166.7,113,28.34,148.3,122,12.61,186.9,121,8.41,10.1,3,2.73,3,\"no\"\n\"6\",\"AL\",118,\"area_code_510\",\"yes\",\"no\",0,223.4,98,37.98,220.6,101,18.75,203.9,118,9.18,6.3,6,1.7,0,\"no\"\n\"7\",\"MA\",121,\"area_code_510\",\"no\",\"yes\",24,218.2,88,37.09,348.5,108,29.62,212.6,118,9.57,7.5,7,2.03,3,\"no\"\n\"8\",\"MO\",147,\"area_code_415\",\"yes\",\"no\",0,157,79,26.69,103.1,94,8.76,211.8,96,9.53,7.1,6,1.92,0,\"no\"\n\"9\",\"LA\",117,\"area_code_408\",\"no\",\"no\",0,184.5,97,31.37,351.6,80,29.89,215.8,90,9.71,8.7,4,2.35,1,\"no\"\n"}]},"apps":[],"jobName":"paragraph_1560823793413_-1535692844","id":"20190618-020953_237374105","dateCreated":"2019-06-18T02:09:53+0000","dateStarted":"2019-06-18T02:10:14+0000","dateFinished":"2019-06-18T02:10:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4424"},{"text":"%pyspark\nraw_data = sc.textFile(\"file:///tmp/churnTrain.csv\")\nheader = raw_data.first()\nheader","user":"anonymous","dateUpdated":"2019-06-18T02:11:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'\"\",\"state\",\"account_length\",\"area_code\",\"international_plan\",\"voice_mail_plan\",\"number_vmail_messages\",\"total_day_minutes\",\"total_day_calls\",\"total_day_charge\",\"total_eve_minutes\",\"total_eve_calls\",\"total_eve_charge\",\"total_night_minutes\",\"total_night_calls\",\"total_night_charge\",\"total_intl_minutes\",\"total_intl_calls\",\"total_intl_charge\",\"number_customer_service_calls\",\"churn\"'\n"}]},"apps":[],"jobName":"paragraph_1560823807157_2112896300","id":"20190618-021007_1063966870","dateCreated":"2019-06-18T02:10:07+0000","dateStarted":"2019-06-18T02:11:49+0000","dateFinished":"2019-06-18T02:11:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4425"},{"text":"%pyspark\nskip_data = raw_data.filter(lambda line: line != header)\nskip_data.take(3)","user":"anonymous","dateUpdated":"2019-06-18T02:12:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['\"1\",\"KS\",128,\"area_code_415\",\"no\",\"yes\",25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10,3,2.7,1,\"no\"', '\"2\",\"OH\",107,\"area_code_415\",\"no\",\"yes\",26,161.6,123,27.47,195.5,103,16.62,254.4,103,11.45,13.7,3,3.7,1,\"no\"', '\"3\",\"NJ\",137,\"area_code_415\",\"no\",\"no\",0,243.4,114,41.38,121.2,110,10.3,162.6,104,7.32,12.2,5,3.29,0,\"no\"']\n"}]},"apps":[],"jobName":"paragraph_1560823909283_1694258848","id":"20190618-021149_770913406","dateCreated":"2019-06-18T02:11:49+0000","dateStarted":"2019-06-18T02:12:25+0000","dateFinished":"2019-06-18T02:12:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4426"},{"text":"%pyspark\nsplitlines = skip_data.map(lambda l: l.split(\",\"))\nsplitlines.take(3)","user":"anonymous","dateUpdated":"2019-06-18T02:12:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['\"1\"', '\"KS\"', '128', '\"area_code_415\"', '\"no\"', '\"yes\"', '25', '265.1', '110', '45.07', '197.4', '99', '16.78', '244.7', '91', '11.01', '10', '3', '2.7', '1', '\"no\"'], ['\"2\"', '\"OH\"', '107', '\"area_code_415\"', '\"no\"', '\"yes\"', '26', '161.6', '123', '27.47', '195.5', '103', '16.62', '254.4', '103', '11.45', '13.7', '3', '3.7', '1', '\"no\"'], ['\"3\"', '\"NJ\"', '137', '\"area_code_415\"', '\"no\"', '\"no\"', '0', '243.4', '114', '41.38', '121.2', '110', '10.3', '162.6', '104', '7.32', '12.2', '5', '3.29', '0', '\"no\"']]\n"}]},"apps":[],"jobName":"paragraph_1560823945719_-1680142248","id":"20190618-021225_1470155187","dateCreated":"2019-06-18T02:12:25+0000","dateStarted":"2019-06-18T02:12:56+0000","dateFinished":"2019-06-18T02:12:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4427"},{"text":"%pyspark\nfrom pyspark.mllib.linalg import Vectors\nfrom pyspark.mllib.regression import LabeledPoint \ndef parseLine(col):\n    features = []\n    churn = col[-1]\n    international = 0 if col[4] == '\"no\"' else 1\n    voice = 0 if col[5] == '\"no\"'  else 1\n    label = 0 if churn == '\"no\"' else 1\n    features.append(international)\n    features.append(voice)\n    features += col[6:-1]\n    return LabeledPoint(label, Vectors.dense(features))\n\ntrainData = splitlines.map(parseLine)\ntrainData.take(3)","user":"anonymous","dateUpdated":"2019-06-18T02:18:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[LabeledPoint(0.0, [0.0,1.0,25.0,265.1,110.0,45.07,197.4,99.0,16.78,244.7,91.0,11.01,10.0,3.0,2.7,1.0]), LabeledPoint(0.0, [0.0,1.0,26.0,161.6,123.0,27.47,195.5,103.0,16.62,254.4,103.0,11.45,13.7,3.0,3.7,1.0]), LabeledPoint(0.0, [0.0,0.0,0.0,243.4,114.0,41.38,121.2,110.0,10.3,162.6,104.0,7.32,12.2,5.0,3.29,0.0])]\n"}]},"apps":[],"jobName":"paragraph_1560823976599_1845757970","id":"20190618-021256_365361836","dateCreated":"2019-06-18T02:12:56+0000","dateStarted":"2019-06-18T02:18:50+0000","dateFinished":"2019-06-18T02:18:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4428"},{"text":"%pyspark\nfrom pyspark.mllib.tree import DecisionTree\n\nmodel = DecisionTree.trainClassifier(trainData, numClasses=2, categoricalFeaturesInfo={},\n                                     impurity='gini', maxDepth=5)\n","user":"anonymous","dateUpdated":"2019-06-18T02:21:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560824218117_147043959","id":"20190618-021658_509081127","dateCreated":"2019-06-18T02:16:58+0000","dateStarted":"2019-06-18T02:21:31+0000","dateFinished":"2019-06-18T02:21:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4429"},{"text":"%pyspark\nprint(\"Learned classification tree model:\")\nprint(model.toDebugString())\n","user":"anonymous","dateUpdated":"2019-06-18T02:30:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Learned classification tree model:\nDecisionTreeModel classifier of depth 5 with 57 nodes\n  If (feature 3 <= 264.7)\n   If (feature 15 <= 3.0)\n    If (feature 0 <= 0.0)\n     If (feature 3 <= 221.4)\n      If (feature 4 <= 120.0)\n       Predict: 0.0\n      Else (feature 4 > 120.0)\n       Predict: 0.0\n     Else (feature 3 > 221.4)\n      If (feature 6 <= 259.8)\n       Predict: 0.0\n      Else (feature 6 > 259.8)\n       Predict: 1.0\n    Else (feature 0 > 0.0)\n     If (feature 13 <= 2.0)\n      Predict: 1.0\n     Else (feature 13 > 2.0)\n      If (feature 12 <= 12.9)\n       Predict: 0.0\n      Else (feature 12 > 12.9)\n       Predict: 1.0\n   Else (feature 15 > 3.0)\n    If (feature 3 <= 161.3)\n     If (feature 6 <= 230.2)\n      If (feature 9 <= 252.7)\n       Predict: 1.0\n      Else (feature 9 > 252.7)\n       Predict: 1.0\n     Else (feature 6 > 230.2)\n      If (feature 3 <= 138.5)\n       Predict: 1.0\n      Else (feature 3 > 138.5)\n       Predict: 0.0\n    Else (feature 3 > 161.3)\n     If (feature 6 <= 156.0)\n      If (feature 3 <= 193.3)\n       Predict: 1.0\n      Else (feature 3 > 193.3)\n       Predict: 0.0\n     Else (feature 6 > 156.0)\n      If (feature 3 <= 179.4)\n       Predict: 0.0\n      Else (feature 3 > 179.4)\n       Predict: 0.0\n  Else (feature 3 > 264.7)\n   If (feature 1 <= 0.0)\n    If (feature 6 <= 184.9)\n     If (feature 9 <= 213.3)\n      If (feature 3 <= 280.4)\n       Predict: 0.0\n      Else (feature 3 > 280.4)\n       Predict: 0.0\n     Else (feature 9 > 213.3)\n      If (feature 6 <= 123.5)\n       Predict: 0.0\n      Else (feature 6 > 123.5)\n       Predict: 1.0\n    Else (feature 6 > 184.9)\n     If (feature 9 <= 123.2)\n      If (feature 10 <= 103.0)\n       Predict: 1.0\n      Else (feature 10 > 103.0)\n       Predict: 0.0\n     Else (feature 9 > 123.2)\n      If (feature 6 <= 201.3)\n       Predict: 1.0\n      Else (feature 6 > 201.3)\n       Predict: 1.0\n   Else (feature 1 > 0.0)\n    If (feature 0 <= 0.0)\n     If (feature 6 <= 259.8)\n      Predict: 0.0\n     Else (feature 6 > 259.8)\n      If (feature 7 <= 103.0)\n       Predict: 0.0\n      Else (feature 7 > 103.0)\n       Predict: 1.0\n    Else (feature 0 > 0.0)\n     If (feature 3 <= 280.4)\n      Predict: 1.0\n     Else (feature 3 > 280.4)\n      If (feature 9 <= 229.8)\n       Predict: 0.0\n      Else (feature 9 > 229.8)\n       Predict: 1.0\n\n"}]},"apps":[],"jobName":"paragraph_1560824491719_211083010","id":"20190618-022131_1642682021","dateCreated":"2019-06-18T02:21:31+0000","dateStarted":"2019-06-18T02:30:47+0000","dateFinished":"2019-06-18T02:30:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4430"},{"text":"%pyspark\nhead = trainData.first()\nprint(model.predict(head.features))\n","user":"anonymous","dateUpdated":"2019-06-18T02:31:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.0\n"}]},"apps":[],"jobName":"paragraph_1560825031317_-1229450809","id":"20190618-023031_574290781","dateCreated":"2019-06-18T02:30:31+0000","dateStarted":"2019-06-18T02:31:20+0000","dateFinished":"2019-06-18T02:31:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4431"},{"text":"%pyspark\npredictions = model.predict(trainData.map(lambda p: p.features))\npredictions.take(3)\n","user":"anonymous","dateUpdated":"2019-06-18T02:32:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0.0, 0.0, 0.0]\n"}]},"apps":[],"jobName":"paragraph_1560825080304_629114596","id":"20190618-023120_519518173","dateCreated":"2019-06-18T02:31:20+0000","dateStarted":"2019-06-18T02:32:17+0000","dateFinished":"2019-06-18T02:32:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4432"},{"text":"%pyspark\nlabels_and_preds = trainData.map(lambda p: p.label).zip(predictions)\nlabels_and_preds.take(3)","user":"anonymous","dateUpdated":"2019-06-18T02:32:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(0.0, 0.0), (0.0, 0.0), (0.0, 0.0)]\n"}]},"apps":[],"jobName":"paragraph_1560825137399_-1168539534","id":"20190618-023217_941009406","dateCreated":"2019-06-18T02:32:17+0000","dateStarted":"2019-06-18T02:32:34+0000","dateFinished":"2019-06-18T02:32:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4433"},{"text":"%pyspark\nfiltered_labels_and_preds = labels_and_preds.filter(lambda v : v[0] == v[1]) \ntest_accuracy = filtered_labels_and_preds.count() / float(trainData.count())\ntest_accuracy","user":"anonymous","dateUpdated":"2019-06-18T02:37:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.9492949294929492\n"}]},"apps":[],"jobName":"paragraph_1560825154192_958767783","id":"20190618-023234_1997512468","dateCreated":"2019-06-18T02:32:34+0000","dateStarted":"2019-06-18T02:37:38+0000","dateFinished":"2019-06-18T02:37:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4434"},{"text":"%pyspark\nfrom pyspark.mllib.evaluation import BinaryClassificationMetrics\n\nmetrics = BinaryClassificationMetrics(labels_and_preds)\n\nprint(\"Area under PR = %s\" % metrics.areaUnderPR)\nprint(\"Area under ROC = %s\" % metrics.areaUnderROC)\n","user":"anonymous","dateUpdated":"2019-06-18T02:38:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Area under PR = 0.8207426929355243\nArea under ROC = 0.9335515176359455\n"}]},"apps":[],"jobName":"paragraph_1560825172889_-1276791893","id":"20190618-023252_629122564","dateCreated":"2019-06-18T02:32:52+0000","dateStarted":"2019-06-18T02:38:39+0000","dateFinished":"2019-06-18T02:38:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4435"},{"text":"%pyspark\nrawData = sc.textFile(\"/tmp/u.data\") \nrawData.first()\n\nrawRatings = rawData.map(lambda e: e.split()) \nrawRatings.take(3)","user":"anonymous","dateUpdated":"2019-06-18T03:24:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['196', '242', '3', '881250949'], ['186', '302', '3', '891717742'], ['22', '377', '1', '878887116']]\n"}]},"apps":[],"jobName":"paragraph_1560825519615_-1644508384","id":"20190618-023839_323064899","dateCreated":"2019-06-18T02:38:39+0000","dateStarted":"2019-06-18T03:24:50+0000","dateFinished":"2019-06-18T03:24:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4436"},{"text":"%pyspark\n\nfrom pyspark.sql import Row\n\nratingsRDD = rawRatings.map(\\\n           lambda p: Row(userId=int(p[0]), \\\n           movieId=int(p[1]), \\\n           rating=float(p[2]), \\\n           timestamp=int(p[3])))\n\nratingsRDD.take(3)","user":"anonymous","dateUpdated":"2019-06-18T03:26:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(movieId=242, rating=3.0, timestamp=881250949, userId=196), Row(movieId=302, rating=3.0, timestamp=891717742, userId=186), Row(movieId=377, rating=1.0, timestamp=878887116, userId=22)]\n"}]},"apps":[],"jobName":"paragraph_1560828284700_-1388329679","id":"20190618-032444_1793010796","dateCreated":"2019-06-18T03:24:44+0000","dateStarted":"2019-06-18T03:26:34+0000","dateFinished":"2019-06-18T03:26:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4437"},{"text":"%pyspark\nratings = spark.createDataFrame(ratingsRDD)\n(training, test) = ratings.randomSplit([0.8, 0.2])","user":"anonymous","dateUpdated":"2019-06-18T03:26:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560828393990_236635136","id":"20190618-032633_2133117334","dateCreated":"2019-06-18T03:26:33+0000","dateStarted":"2019-06-18T03:26:56+0000","dateFinished":"2019-06-18T03:26:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4438"},{"text":"%pyspark\nfrom pyspark.ml.recommendation import ALS\nals = ALS(rank=50, maxIter=10, regParam=0.01, \\\n      userCol=\"userId\", itemCol=\"movieId\", \\\n      ratingCol=\"rating\")\nmodel = als.fit(training)\nmodel","user":"anonymous","dateUpdated":"2019-06-18T03:30:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ALS_458c896745f023f02aa8\n"}]},"apps":[],"jobName":"paragraph_1560828416222_-1192291630","id":"20190618-032656_1593758848","dateCreated":"2019-06-18T03:26:56+0000","dateStarted":"2019-06-18T03:30:59+0000","dateFinished":"2019-06-18T03:31:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4439"},{"text":"%pyspark\nmodel.itemFactors.count()\n","user":"anonymous","dateUpdated":"2019-06-18T03:32:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1646\n"}]},"apps":[],"jobName":"paragraph_1560828640289_1647833329","id":"20190618-033040_990021724","dateCreated":"2019-06-18T03:30:40+0000","dateStarted":"2019-06-18T03:32:01+0000","dateFinished":"2019-06-18T03:32:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4440"},{"text":"%pyspark\nmodel.userFactors.count()","user":"anonymous","dateUpdated":"2019-06-18T03:32:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"943\n"}]},"apps":[],"jobName":"paragraph_1560828709159_186247234","id":"20190618-033149_1671307116","dateCreated":"2019-06-18T03:31:49+0000","dateStarted":"2019-06-18T03:32:04+0000","dateFinished":"2019-06-18T03:32:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4441"},{"text":"%pyspark\nuserRecs = model.recommendForAllUsers(10)\nuserRecs.select('recommendations').take(1)\n","user":"anonymous","dateUpdated":"2019-06-18T03:32:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(recommendations=[Row(movieId=723, rating=5.093173027038574), Row(movieId=405, rating=5.0752339363098145), Row(movieId=262, rating=5.013440132141113), Row(movieId=477, rating=4.984289169311523), Row(movieId=102, rating=4.984144687652588), Row(movieId=225, rating=4.978042125701904), Row(movieId=140, rating=4.966893672943115), Row(movieId=393, rating=4.964749813079834), Row(movieId=422, rating=4.96357536315918), Row(movieId=932, rating=4.963431358337402)])]\n"}]},"apps":[],"jobName":"paragraph_1560828723959_1419782856","id":"20190618-033203_272078643","dateCreated":"2019-06-18T03:32:03+0000","dateStarted":"2019-06-18T03:32:34+0000","dateFinished":"2019-06-18T03:32:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4442"},{"text":"%pyspark\n\nmovieRecs = model.recommendForAllItems(10)\nmovieRecs.select('recommendations').take(1)","user":"anonymous","dateUpdated":"2019-06-18T03:33:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(recommendations=[Row(userId=405, rating=1.018172264099121), Row(userId=223, rating=0.35002854466438293), Row(userId=15, rating=0.34987807273864746), Row(userId=589, rating=0.32147619128227234), Row(userId=752, rating=0.31107044219970703), Row(userId=632, rating=0.30480366945266724), Row(userId=14, rating=0.26613324880599976), Row(userId=746, rating=0.26249459385871887), Row(userId=432, rating=0.2617129683494568), Row(userId=777, rating=0.25859129428863525)])]\n"}]},"apps":[],"jobName":"paragraph_1560828754211_-1110695336","id":"20190618-033234_1799757672","dateCreated":"2019-06-18T03:32:34+0000","dateStarted":"2019-06-18T03:33:50+0000","dateFinished":"2019-06-18T03:34:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4443"},{"text":"%pyspark\nfrom pyspark.ml.evaluation import RegressionEvaluator\npredictions = model.transform(test).na.drop()\nevaluator = RegressionEvaluator(metricName=\"rmse\",labelCol=\"rating\",predictionCol=\"prediction\") \nrmse = evaluator.evaluate(predictions)\nrmse","user":"anonymous","dateUpdated":"2019-06-18T03:35:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1.2228271041037493\n"}]},"apps":[],"jobName":"paragraph_1560828830549_-1948739737","id":"20190618-033350_268695974","dateCreated":"2019-06-18T03:33:50+0000","dateStarted":"2019-06-18T03:35:41+0000","dateFinished":"2019-06-18T03:36:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4444"},{"text":"%sh\nwget https://raw.githubusercontent.com/ywchiu/ctbcpy/master/data/iris.csv\nmv iris.csv /tmp/","user":"anonymous","dateUpdated":"2019-06-18T05:55:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560828941272_-568859971","id":"20190618-033541_923171549","dateCreated":"2019-06-18T03:35:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4445","dateFinished":"2019-06-18T05:55:32+0000","dateStarted":"2019-06-18T05:55:29+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2019-06-18 05:55:32--  https://raw.githubusercontent.com/ywchiu/ctbcpy/master/data/iris.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3858 (3.8K) [text/plain]\nSaving to: ‘iris.csv’\n\n     0K ...                                                   100% 7.54M=0s\n\n2019-06-18 05:55:32 (7.54 MB/s) - ‘iris.csv’ saved [3858/3858]\n\n"}]}},{"text":"%sh\nhead /tmp/iris.csv","user":"anonymous","dateUpdated":"2019-06-18T05:55:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837329456_965605352","id":"20190618-055529_148867723","dateCreated":"2019-06-18T05:55:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5051","dateFinished":"2019-06-18T05:55:39+0000","dateStarted":"2019-06-18T05:55:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sepal_length,sepal_width,petal_length,petal_width,species\n5.1,3.5,1.4,0.2,setosa\n4.9,3.0,1.4,0.2,setosa\n4.7,3.2,1.3,0.2,setosa\n4.6,3.1,1.5,0.2,setosa\n5.0,3.6,1.4,0.2,setosa\n5.4,3.9,1.7,0.4,setosa\n4.6,3.4,1.4,0.3,setosa\n5.0,3.4,1.5,0.2,setosa\n4.4,2.9,1.4,0.2,setosa\n"}]}},{"text":"%pyspark\nraw_data = sc.textFile('file:/tmp/iris.csv')\nraw_data.take(3)\n","user":"anonymous","dateUpdated":"2019-06-18T05:56:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837338915_1807451269","id":"20190618-055538_761882410","dateCreated":"2019-06-18T05:55:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5146","dateFinished":"2019-06-18T05:56:06+0000","dateStarted":"2019-06-18T05:56:05+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['sepal_length,sepal_width,petal_length,petal_width,species', '5.1,3.5,1.4,0.2,setosa', '4.9,3.0,1.4,0.2,setosa']\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837358709_-1521983467","id":"20190618-055558_94290056","dateCreated":"2019-06-18T05:55:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5218","text":"%pyspark \nheader = raw_data.first()","dateUpdated":"2019-06-18T05:56:37+0000","dateFinished":"2019-06-18T05:56:37+0000","dateStarted":"2019-06-18T05:56:37+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837387260_-469664577","id":"20190618-055627_498636884","dateCreated":"2019-06-18T05:56:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5320","text":"%pyspark \nskip_data = raw_data.filter(lambda line : line != header)\nskip_data.take(3)","dateUpdated":"2019-06-18T05:57:02+0000","dateFinished":"2019-06-18T05:57:02+0000","dateStarted":"2019-06-18T05:57:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['5.1,3.5,1.4,0.2,setosa', '4.9,3.0,1.4,0.2,setosa', '4.7,3.2,1.3,0.2,setosa']\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837408488_886621269","id":"20190618-055648_355810017","dateCreated":"2019-06-18T05:56:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5394","text":"%pyspark \nimport numpy \nparsedData = skip_data.map(lambda e: \\\n    numpy.array( [float(ele) for ele in e.split(',')[0:4]] ) )\nparsedData.take(3)\n","dateUpdated":"2019-06-18T05:57:43+0000","dateFinished":"2019-06-18T05:57:43+0000","dateStarted":"2019-06-18T05:57:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[array([ 5.1,  3.5,  1.4,  0.2]), array([ 4.9,  3. ,  1.4,  0.2]), array([ 4.7,  3.2,  1.3,  0.2])]\n"}]}},{"text":"%pyspark\nfrom pyspark.mllib.clustering import KMeans\nclusters = KMeans.train(parsedData, 3, maxIterations=100,runs=30, initializationMode=\"random\")","user":"anonymous","dateUpdated":"2019-06-18T05:59:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837463172_644876366","id":"20190618-055743_195175793","dateCreated":"2019-06-18T05:57:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5469","dateFinished":"2019-06-18T05:59:35+0000","dateStarted":"2019-06-18T05:59:35+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\niris1 = parsedData.first()\niris1","user":"anonymous","dateUpdated":"2019-06-18T05:59:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837516869_1394660027","id":"20190618-055836_417834491","dateCreated":"2019-06-18T05:58:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5553","dateFinished":"2019-06-18T05:59:40+0000","dateStarted":"2019-06-18T05:59:40+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"array([ 5.1,  3.5,  1.4,  0.2])\n"}]}},{"text":"%pyspark\n\nclusters.predict(iris1)","user":"anonymous","dateUpdated":"2019-06-18T05:59:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837535519_300834229","id":"20190618-055855_1295361385","dateCreated":"2019-06-18T05:58:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5636","dateFinished":"2019-06-18T05:59:43+0000","dateStarted":"2019-06-18T05:59:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0\n"}]}},{"text":"%pyspark\nprediction = clusters.predict(parsedData)\nprediction.collect()","user":"anonymous","dateUpdated":"2019-06-18T05:59:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837539296_75386697","id":"20190618-055859_828517846","dateCreated":"2019-06-18T05:58:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5708","dateFinished":"2019-06-18T05:59:46+0000","dateStarted":"2019-06-18T05:59:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2]\n"}]}},{"text":"%pyspark\nfrom math import sqrt\ndef error(point):\n    center = clusters.centers[clusters.predict(point)] \n    return sqrt(sum([x**2 for x in (point - center)]))","user":"anonymous","dateUpdated":"2019-06-18T06:00:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837552965_-554447252","id":"20190618-055912_1230791700","dateCreated":"2019-06-18T05:59:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5780","dateFinished":"2019-06-18T06:00:19+0000","dateStarted":"2019-06-18T06:00:19+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\nparsedData.take(3)\nWSSSE = parsedData.map(lambda point: error(point)).reduce(lambda x,y: x+ y)\nWSSSE","user":"anonymous","dateUpdated":"2019-06-18T06:00:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837619126_-1237468495","id":"20190618-060019_385851636","dateCreated":"2019-06-18T06:00:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5937","dateFinished":"2019-06-18T06:00:38+0000","dateStarted":"2019-06-18T06:00:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"97.20457357401652\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-06-18T06:00:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560837638157_-101492172","id":"20190618-060038_589758299","dateCreated":"2019-06-18T06:00:38+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5993"}],"name":"Demo20190618","id":"2EDXAK7UE","angularObjects":{"2ECB8EECR:shared_process":[],"2ED1HD7NS:shared_process":[],"2EE9P3FDB:shared_process":[],"2EFC7YPSA:shared_process":[],"2EDTYY9UC:shared_process":[],"2EF7FMM2J:shared_process":[],"2EEFHWQN7:shared_process":[],"2EC3SCQSX:shared_process":[],"2EE19MJ8U:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}